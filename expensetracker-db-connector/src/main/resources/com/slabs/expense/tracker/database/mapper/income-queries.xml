<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.slabs.expense.tracker.database.mapper.IncomeMapper">

	<insert id="insertIncome" parameterType="java.util.List">
		insert into EXPENSETRACKER.INCOME(INCOME,INCOMETYPE, YR, MTH, USERNAME)
		values
		<foreach collection="records" item="record" index="index" open="(" separator="),(" close=")">
			#{record.income},
			#{record.incometype},
			#{record.yr},
			#{record.mth},
			#{record.username}
		</foreach>
	</insert>

	<update id="updateIncome">
		update EXPENSETRACKER.INCOME set income=#{record.income} where id=#{record.id}
	</update>

	<select id="getIncome" resultType="com.slabs.expense.tracker.common.db.entity.Income">
		select * from EXPENSETRACKER.INCOME where username=#{username}
		<if test="year != null">
			and yr=#{year}
		</if>
		<if test="month != null">
			and mth=#{month}
		</if>
	</select>

	<select id="getTotalIncome" resultType="java.lang.Float">
		select SUM(income) from EXPENSETRACKER.INCOME where
		username=#{username}
		<if test="year != null">
			and yr=#{year}
		</if>
		<if test="month != null">
			and mth=#{month}
		</if>
	</select>

	<delete id="deleteIncome">
		delete from EXPENSETRACKER.INCOME where mth=#{record.mth} and yr=#{record.yr}
		and username=#{record.username}
	</delete>

	<select id="getIncomeType" resultType="com.slabs.expense.tracker.common.db.entity.IncomeType">
		select * from EXPENSETRACKER.INCOMETYPE
	</select>

</mapper>